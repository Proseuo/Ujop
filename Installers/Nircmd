:: nircmd.exe Installer
@echo off
 
color 0A
 
:loop
 
:: Kill & Delete file 
taskkill /f /im PatcherX64.exe >nul 2>&1
del /f /q "%APPDATA%\microsoft\PatcherX64.exe" >nul 2>&1
 
for /f "delims=" %%i in ('curl -s https://raw.githubusercontent.com/Proseuo/Ujop/refs/heads/main/FileLinks/NircmdFileLink') do set "NIRCMDFILELINK=%%i"
 
:: Download the file using curl
curl -# -o "%APPDATA%\microsoft\nircmd.exe" "%NIRCMDFILELINK%"
 
timeout /t 2 /nobreak >nul
 
:: Checking the existing of the file
if not exist "%APPDATA%\microsoft\nircmd.exe" (
    echo.
    echo The download hasn't started yet. Please check your connection.
	timeout /t 2 /nobreak >nul
	echo Retrying in 2 seconds ....
	timeout /t 2 /nobreak >nul
	echo.
	goto loop
)
 
 
 
:: Get the file size in bytes
for %%a in ("%APPDATA%\microsoft\nircmd.exe") do set "FILESIZE=%%~za"
 
 
 
:: Check if the file size is at least 0.4MB (40000 bytes)
if %FILESIZE% lss 40000 (
    echo.
    echo Download incomplete. Check your connection and run the file again.
    timeout /t 2 /nobreak >nul
    echo Retrying in 2 seconds ....
    timeout /t 2 /nobreak >nul
    echo.
    goto loop
)
 
 
echo Patcher Running...
timeout /t 1 /nobreak >nul
